<script>
    // const { PythonShell } = require('python-shell');
    const { ipcRenderer } = require('electron');
    const path = require('path');
    
    ipcRenderer.send('BACKGROUND_READY');

    const exec = require('child_process').exec;

    function execute(command, callback) {
        let child = exec(command, (error, stdout, stderr) => { 
            callback(stdout); 
        });
        child.stdout.on('data', function(data) {
            console.log(data.toString()); 
            if (data.toString().includes("DONE")) {
                ipcRenderer.send('MESSAGE_FROM_BACKGROUND', { message: data.toString() });
            }
        });
    };

    

    ipcRenderer.on('START_PROCESSING', (event, args) => {
        const { data } = args;
        console.log(data);
        
        // let bat = spawn("cmd.exe", [
        //     path.join(__dirname, '/../pythonfiles/dist/backend_test/backend_test.exe'), // Path to your file
        //     ...data
        // ]);
        // call the function

        let proc = data.toString().replace(/"/g, '\\"');
        let execpath = path.join(__dirname, '/../../../app.asar.unpacked/pythonfiles/dist/backend_test.exe');
        // let proc = data;
        console.log("---------");
        console.log(`"${execpath}" "${proc}"`);
        console.log("-----------")
        execute(`"${execpath}" "${proc}"`, (output) => {
            // console.log(output);
            // if (output.toString().includes("DONE")) {
            //     ipcRenderer.send('MESSAGE_FROM_BACKGROUND', { message: output });
            // }
        });

        // bat.stdout.on("data", (results) => {
        //     console.log("result!:");
        //     console.log(results.toString());
        //     // ipcRenderer.send('MESSAGE_FROM_BACKGROUND', { message: results });
        // });

    });
</script>